#! /usr/bin/env node
console.log(__dirname)
'use strict';var PQueue=require('p-queue'),request=require('request-promise'),cheerio=require('cheerio'),json=require('jsonfile'),start=+new Date,page=1,links=[],queue=new PQueue({concurrency:10}),crawl=function(a){var b=cheerio.load(a);b('.athing').length?(b('.athing').each(function(c,d){links.push({url:b(d).find('.storylink').attr('href'),text:b(d).find('.storylink').text()})}),queue.add(function(){return request('https://news.ycombinator.com/news?p='+ ++page)}).then(crawl)):(console.log('Completed in '+(1e-3*(+new Date-start)).toFixed(2)+' second.\n'+links.length+' link saved to news.json file.'),json.writeFileSync(process.cwd()+'/news.json',links))};queue.add(function(){return request('https://news.ycombinator.com/news?p='+page)}).then(crawl);
